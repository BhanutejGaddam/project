
<section class="service-tracking" aria-labelledby="service-tracking-title">
  <h2 id="service-tracking-title">Service Progress</h2>

  @if (bookingSig()) {
    <!-- Connector rail is a dotted line behind these items -->
    <ol class="timeline" role="list" aria-label="Service status timeline">
      @for (s of stageData(); track s.key; let i = $index) {
        <li
          class="timeline-item"
          [attr.data-status]="stepState(i)"
          [attr.aria-current]="stepState(i) === 'current' ? 'step' : null"
        >
          <!-- Dot -->
          <span class="dot" aria-hidden="true">
            @if (stepState(i) === 'completed') {
              <span class="dot-check">✓</span>
            } @else if (stepState(i) === 'current') {
              <span class="dot-current"></span>
            } @else {
              <span class="dot-pending"></span>
            }
          </span>

          <!-- Text -->
          <div class="content">
            <div class="title">{{ s.title }}</div>

            @if (s.meta) {
              <div class="meta">{{ s.meta }}</div>
            }

            @if (s.key === 'SERVICE_IN_PROGRESS' && stepState(i) !== 'pending') {
              <div class="desc">General servicing, fluid checks, brake inspection.</div>
            }
          </div>
        </li>
      }
    </ol>

    <!-- Optional details -->
    <div class="context">
      <div class="context-row">
        <span class="label">Customer:</span>
        <span class="value">{{ bookingSig()!.ownerName }}</span>
      </div>
      <div class="context-row">
        <span class="label">Vehicle:</span>
        <span class="value">{{ bookingSig()!.makeModelYear }} • {{ bookingSig()!.registration }}</span>
      </div>
      <div class="context-row">
        <span class="label">Current Status:</span>
        <span class="value status-pill">{{ statusSig() }}</span>
      </div>
    </div>
  } @else {
    <div class="not-found">
      <p>No booking found for: <strong>rahul.sharma&#64;example.com</strong></p>
      <p>Please verify the email or seed data.</p>
    </div>
  }
</section>
