<div class="header">
  <h2>Customers details</h2>
</div>
<br>
  <div class="toolbar">
    <button class="btn btn-outline" type="button" (click)="openAddForm()">âž• Add Customer</button>
  </div>

<div *ngIf="showForm" class="card">
    <h5>Add New Customer</h5>

    <form (ngSubmit)="saveCustomer()" [formGroup]="addForm" novalidate>
      <div class="form-grid">
        <div class="form-group">
          <label class="form-label">Customer Name:</label>
          <input type="text" class="form-control" formControlName="customerName" name="customerName" placeholder="e.g., Ram" required />
        </div>

        <div class="form-group">
          <label class="form-label">Address:</label>
          <input type="text" class="form-control" formControlName="customerAddress" name="customerAddress" placeholder="e.g., Kalyani Nagar, Pune 411006" required />
        </div>
        

        <div class="form-group">
          <label class="form-label">Vehicle Number: </label>
          <input type="text" class="form-control" formControlName="vehicleNumber" name="vehicleNumber" placeholder="MH EF14 2875" required />
        </div>

        <div class="form-group">
          <label class="form-label">Vehicle Purchase date: </label>
          <input type="date" class="form-control" formControlName="vehiclePurchaseDate" name="vehiclePurchaseDate" required />
        </div>

        <div class="form-group">
          <label class="form-label">Customer mail: </label>
          <input type="text" class="form-control" formControlName="customerMail" name="customerMail" placeholder="customer@example.com" required />
        </div>

        <div class="form-group">
          <label class="form-label">Customer Phone Number: </label>
          <input type="number" class="form-control" formControlName="customerPhoneNumber" name="customerPhoneNumber" placeholder="1234567890" required />
        </div>
      </div>
      <br><br>
      <div class="actions">
        <button type="button" class="btn btn-outline" (click)="cancelAddCustomer()">Cancel</button>
        <button type="submit" class="btn btn-primary">Add Customer</button>
      </div>
    </form>
  </div>

<br>
<form [formGroup]="form">
  <label for="customer_name">Search by customer name:</label>
  <input type="text" id="customer_name" formControlName="search" placeholder="Type a name..." />
</form>
<br><br>
<div>
  <table>
    <thead>
      <tr>
        <th>SL.NO</th>
        <th>Customer Name</th>
        <th>Vehicle Number</th>
        <th>Vehicle Purchase Date</th>
        <th>Loyalty Points</th>
        <th>Offers Eligible</th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>
      @if ((entered_text().trim().length) > 0) {
        @for (customer of search_result(); track customer.customer_id) {
          <tr>
            <td>{{ customer.sl_no }}</td>
            <td>{{ customer.customer_name }}</td>
            <td>{{ customer.vehicle_id }}</td>
            <td>{{ customer.purchase_date }}</td>
            <td>{{ customer.loyalty_points }}</td>
            <td>{{ customer.offers_eligible }}</td>
            <td><button class="btn" type="button" [routerLink]="['/dealer', 'customers', 'servicehistory', customer.vehicle_id]">View Service History</button></td>
          </tr>
        } @empty {
          <tr><td colspan="7" style="text-align:center">No customers found</td></tr>
        }
      } @else {
        @for (customer of customers_sig(); track customer.customer_id) {
          <tr>
            <td>{{ customer.sl_no }}</td>
            <td>{{ customer.customer_name }}</td>
            <td>{{ customer.vehicle_id }}</td>
            <td>{{ customer.purchase_date }}</td>
            <td>{{ customer.loyalty_points }}</td>
            <td>{{ customer.offers_eligible }}</td>
            <td><button class="btn" type="button" [routerLink]="['/dealer', 'customers', 'servicehistory', customer.vehicle_id]">View Service History</button></td>
          </tr>
        }
      }
    </tbody>
  </table>
</div>