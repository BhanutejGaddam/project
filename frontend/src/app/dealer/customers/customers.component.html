<div class="header">
  <h2>Customers details</h2>
</div>
<br>
  <div class="toolbar">
    <button class="btn btn-outline" type="button" (click)="openAddForm()">âž• Add Customer</button>
  </div>

<div *ngIf="showForm" class="card">
  <h5>Add New Customer</h5>

  <form (ngSubmit)="saveCustomer()" [formGroup]="addForm" novalidate>
    <div class="form-grid">
      
      <div class="form-group">
        <label class="form-label">First Name:</label>
        <input type="text" class="form-control" formControlName="c_first_name" placeholder="e.g., Ram" required />
      </div>

      <div class="form-group">
        <label class="form-label">Middle Name:</label>
        <input type="text" class="form-control" formControlName="c_middle_name" placeholder="e.g., Kumar" required />
      </div>

      <div class="form-group">
        <label class="form-label">Last Name:</label>
        <input type="text" class="form-control" formControlName="c_last_name" placeholder="e.g., Sharma" required />
      </div>

      <div class="form-group">
        <label class="form-label">Username:</label>
        <input type="text" class="form-control" formControlName="c_username" placeholder="ram_sharma123" required />
      </div>

      <div class="form-group">
        <label class="form-label">Password:</label>
        <input type="password" class="form-control" formControlName="c_password" placeholder="********" required />
      </div>

      <div class="form-group">
        <label class="form-label">Customer Mail:</label>
        <input type="email" class="form-control" formControlName="c_mail_id" placeholder="customer@example.com" required />
      </div>

      <div class="form-group">
        <label class="form-label">Phone Number:</label>
        <input type="number" class="form-control" formControlName="c_contact_info" placeholder="9876543210" required />
      </div>

      <div class="form-group">
        <label class="form-label">Address:</label>
        <input type="text" class="form-control" formControlName="c_address" placeholder="e.g., Kalyani Nagar, Pune" required />
      </div>

      <div class="form-group">
        <label class="form-label">Vehicle Model Year:</label>
        <input type="text" class="form-control" formControlName="vehicle_model_year" placeholder="e.g., 2024" required />
      </div>

      <div class="form-group">
        <label class="form-label">Purchase Date:</label>
        <input type="date" class="form-control" formControlName="purchase_date" required />
      </div>

      <div class="form-group">
        <label class="form-label">Enter your Dealer_id:</label>
        <input type="text" class="form-control" formControlName="dealer_id" placeholder="0" required />
      </div>

    </div>

    <div class="actions">
      <button type="button" class="btn btn-outline" (click)="cancelAddCustomer()">Cancel</button>
      <button type="submit" class="btn btn-primary">Add Customer</button>
    </div>
  </form>
</div>

<br>
<form [formGroup]="form">
  <label for="customer_name">Search by customer name:</label>
  <input type="text" id="customer_name" formControlName="search" placeholder="Type a name..." />
</form>
<br><br>
<div>
  <table>
    <thead>
      <tr>
        <th>SL.NO</th>
        <th>Customer Name</th>
        <th>Vehicle Number</th>
        <th>Vehicle Purchase Date</th>
        <th>Loyalty Points</th>
        <th>Offers Eligible</th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>
      @if ((entered_text().trim().length) > 0) {
        @for (customer of search_result(); track customer.customer_id) {
          <tr>
            <td>{{ customer.sl_no }}</td>
            <td>{{ customer.customer_name }}</td>
            <td>{{ customer.vehicle_id }}</td>
            <td>{{ customer.purchase_date }}</td>
            <td>{{ customer.loyalty_points }}</td>
            <td>{{ customer.offers_eligible }}</td>
            <td><button class="btn" type="button" [routerLink]="['/dealer', 'customers', 'servicehistory', customer.vehicle_id]">View Service History</button></td>
          </tr>
        } @empty {
          <tr><td colspan="7" style="text-align:center">No customers found</td></tr>
        }
      } @else {
        @for (customer of customers_sig(); track customer.customer_id) {
          <tr>
            <td>{{ customer.sl_no }}</td>
            <td>{{ customer.customer_name }}</td>
            <td>{{ customer.vehicle_id }}</td>
            <td>{{ customer.purchase_date }}</td>
            <td>{{ customer.loyalty_points }}</td>
            <td>{{ customer.offers_eligible }}</td>
            <td><button class="btn" type="button" [routerLink]="['/dealer', 'customers', 'servicehistory', customer.vehicle_id]">View Service History</button></td>
          </tr>
        }
      }
    </tbody>
  </table>
</div>